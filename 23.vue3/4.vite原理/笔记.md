# vite原理

## 复习webpack原理
给一个入口文件，通过入口文件找依赖（依赖包括很多js文件，css文件等一大堆模块），通过loader和plugin打包，打包后变成体积很小的一个或多个文件，然后在开发服务器运行

## vite原理

首先启动一个服务器(不管有多少个模块,根据不同的请求,给你不同的东西, 开发阶段在本地,请求多了本地也很快,  浏览器必须支持type=module,现代浏览器)，先请求页面，页面自动发送请求到main.js,main.js依赖的其他模块,在发送对应的请求,当请求模块到开发服务器，开发服务器把编译的结果返回,
把css编译成了字符串,把组件编译成纯js文件,把模板编译成render函数


## 谈谈webpack和vite的理解

webpack会先打包,然后启动开发服务器,请求服务器时,直接给予打包结果,
而vite是直接启动开发服务器,请求哪个模块再对哪个模块进行实时编译
由于现代浏览器本身就支持ES module,会自动想依赖的Module发送请求,而vite充分利用了这一点,将开发环境下的模块文件,作为浏览器要执行的文件,而不是像webpack那样进行打包合并
由于vite在启动的时候不需要打包,也就意味着不需要分析模块的依赖,不需要编译,因此启动速度非常快,到哪个浏览器请求某个模块时,在根据需要对模块的内容进行编译,这种按需动态编译的方式,极大的缩减了编译时间,项目越复杂,模块越多,vite的优势越明显
在HMR方面,当改动一个模块后,仅需让浏览器重新请求该模块即可,不象webpack那样把模块相关依赖的模块全部编译一次,效率更高
当需要打包到生产环境,vite使用传统的rollup进行打包,因此,vite的主要优势还是在开发阶段,另外,由于vite利用的是es module,因此代码中不可使用commonjs